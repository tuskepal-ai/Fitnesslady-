<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fitness Lady ‚Äî Admin</title>
  <meta name="description" content="FitnessLady admin fel√ºlet (teszt). Vev≈ëk kezel√©se, csomagok, hozz√°f√©r√©s, slotok, export/import." />

  <style>
    :root{
      --bg:#07060b;

      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.70);
      --muted2:rgba(255,255,255,.55);

      --pink:#ff4fd8;
      --pink2:#b14cff;
      --gold:#ffd38a;

      --radius:22px;
      --shadow: 0 18px 55px rgba(0,0,0,.55);
      --max: 1180px;

      --panel: rgba(12,10,18,.62);
      --panel2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.14);

      --ok: rgba(65, 255, 170, .95);
      --warn: rgba(255, 215, 130, .95);
      --bad: rgba(255, 88, 122, .95);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(255,79,216,.16), transparent 60%),
        radial-gradient(1100px 700px at 80% 20%, rgba(177,76,255,.14), transparent 60%),
        radial-gradient(900px 650px at 70% 90%, rgba(255,211,138,.07), transparent 55%),
        var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }

    /* Full-page background (optional) */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      z-index: -1;
      background-image: url("/hero.png");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: .45;
      transform: translate3d(0,0,0);
      backface-visibility: hidden;
      will-change: transform;
    }

    a{ color:inherit; text-decoration:none; }
    button{ font:inherit; }

    .container{
      width: min(var(--max), 92vw);
      margin: 0 auto;
    }

    /* ========= Topbar ========= */
    .topbar{
      position: fixed;
      top:0; left:0; right:0;
      z-index: 50;
      background: rgba(8,6,12,.62);
      border-bottom: 1px solid rgba(255,255,255,.06);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    .topbar-inner{
      height: 64px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:900;
      letter-spacing:.2px;
      white-space: nowrap;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #ffd0f6, var(--pink));
      box-shadow: 0 0 18px rgba(255,79,216,.7);
      flex: 0 0 auto;
    }

    .nav{
      display:flex;
      align-items:center;
      gap: 16px;
      color: var(--muted);
      font-size: 14px;
      font-weight: 750;
    }
    .nav a{
      position: relative;
      padding: 10px 6px;
      opacity:.92;
    }
    .nav a:hover{ opacity:1; color: var(--text); }
    .nav a::after{
      content:"";
      position:absolute;
      left: 8px; right: 8px; bottom: 6px;
      height: 2px;
      border-radius: 99px;
      background: linear-gradient(90deg, rgba(255,215,140,0), rgba(255,215,140,.9), rgba(255,215,140,0));
      transform: scaleX(0);
      transform-origin: left;
      opacity: 0;
      transition: transform .28s ease, opacity .28s ease;
    }
    .nav a:hover::after,
    .nav a.is-active::after{
      transform: scaleX(1);
      opacity: 1;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      font-weight: 900;
      white-space: nowrap;
      cursor:pointer;
      transition: transform .18s ease, border-color .18s ease, background .18s ease;
    }
    .pill:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.20); }
    .pill.primary{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      border-color: rgba(255,255,255,.18);
      color:#140813;
      box-shadow: 0 18px 46px rgba(255,79,216,.20);
    }
    .pill.ghost{
      background: rgba(20,12,26,.55);
      border-color: rgba(255,255,255,.12);
      color: var(--text);
      box-shadow: 0 14px 40px rgba(0,0,0,.35);
    }

    .menu-btn{
      width: 40px; height: 40px; border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--text);
      display:none;
      align-items:center; justify-content:center;
      cursor:pointer;
    }

    /* ========= Base layout ========= */
    .page{ padding-top: 64px; min-height: 100vh; }

    .glass{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    .interactive{
      position: relative;
      overflow: hidden;
      transition: transform .30s cubic-bezier(.2,.8,.2,1), box-shadow .30s ease, border-color .30s ease;
      will-change: transform;
    }
    .interactive::before{
      content:"";
      position:absolute; inset:-3px;
      border-radius: inherit;
      background:
        radial-gradient(700px 240px at 12% 0%, rgba(255,79,216,.32), transparent 55%),
        radial-gradient(700px 260px at 90% 20%, rgba(177,76,255,.26), transparent 60%);
      opacity: 0;
      filter: blur(6px);
      transition: opacity .30s ease;
      pointer-events:none;
    }
    .interactive:hover,
    .interactive:focus-visible,
    .interactive.is-active{
      transform: translateY(-6px);
      border-color: rgba(255,255,255,.16);
      box-shadow: 0 22px 70px rgba(0,0,0,.55);
    }
    .interactive:hover::before,
    .interactive:focus-visible::before,
    .interactive.is-active::before{ opacity: 1; }

    .hero{
      padding: clamp(22px, 4.8vw, 44px) 0 12px;
    }
    .hero-grid{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap: 16px;
      align-items:start;
    }
    .kicker{
      display:inline-flex; align-items:center; gap:10px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-size: 13px;
      width: fit-content;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      font-weight: 900;
    }
    .h1{
      margin: 14px 0 10px;
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      font-weight: 750;
      line-height: 1.06;
      letter-spacing: -.7px;
      font-size: clamp(28px, 3.6vw, 46px);
      text-shadow: 0 10px 40px rgba(0,0,0,.55);
    }
    .lead{
      margin: 0 0 14px;
      color: var(--muted);
      font-size: 15px;
      line-height: 1.65;
      max-width: 80ch;
      text-shadow: 0 10px 30px rgba(0,0,0,.45);
    }

    .card{ padding: 18px; }
    .title-row{
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 10px;
    }
    .title{
      margin:0;
      font-size: 16px;
      font-weight: 950;
      letter-spacing:.2px;
    }
    .tag{
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.07);
      color: var(--muted);
      white-space: nowrap;
      font-weight: 900;
    }
    .tag.ok{ color: #0b1b12; background: linear-gradient(135deg, rgba(65,255,170,.92), rgba(160,255,215,.78)); border-color: rgba(255,255,255,.18); }
    .tag.warn{ color: #221606; background: linear-gradient(135deg, rgba(255,215,130,.92), rgba(255,160,120,.78)); border-color: rgba(255,255,255,.18); }
    .tag.bad{ color: #25040d; background: linear-gradient(135deg, rgba(255,88,122,.92), rgba(255,140,190,.78)); border-color: rgba(255,255,255,.18); }

    .small{ margin:0; color: var(--muted); font-size: 13.5px; line-height: 1.6; }

    .meta-row{
      display:flex; flex-wrap:wrap;
      gap: 10px;
      margin-top: 10px;
      color: var(--muted2);
      font-size: 13px;
    }
    .meta-pill{
      display:inline-flex; align-items:center; gap:8px;
      padding: 9px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      white-space: nowrap;
    }

    .section{
      padding: clamp(18px, 4.5vw, 38px) 0;
    }
    .section-head{
      display:flex;
      align-items:flex-end;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }
    .section-title{
      margin:0;
      font-family: ui-serif, Georgia, serif;
      font-size: clamp(22px, 2.6vw, 32px);
      letter-spacing: -.4px;
    }
    .section-sub{
      margin: 6px 0 0;
      color: var(--muted);
      line-height: 1.6;
      font-size: 14px;
      max-width: 82ch;
    }

    .layout{
      display:grid;
      grid-template-columns: 0.95fr 1.05fr;
      gap: 16px;
      align-items:start;
    }

    .row{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .input, .select, .textarea{
      width: 100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline: none;
    }
    .textarea{ resize: vertical; min-height: 92px; }
    .label{
      display:grid;
      gap: 6px;
      margin-top: 10px;
    }
    .label span{
      color: var(--muted);
      font-size: 13px;
      font-weight: 900;
      letter-spacing:.1px;
    }
    .grid-2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .table{
      width:100%;
      border-collapse: collapse;
      overflow: hidden;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
    }
    .table th, .table td{
      padding: 10px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      text-align:left;
      font-size: 13px;
      color: rgba(255,255,255,.86);
      vertical-align: top;
    }
    .table th{
      color: rgba(255,255,255,.78);
      font-weight: 950;
      letter-spacing:.15px;
      background: rgba(255,255,255,.04);
    }
    .table tr:hover td{
      background: rgba(255,255,255,.03);
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12.5px;
      color: rgba(255,255,255,.78);
    }

    .hint{
      margin-top: 10px;
      padding: 12px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color: rgba(255,255,255,.75);
      font-size: 13px;
      line-height: 1.6;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.86);
      font-size: 12px;
      font-weight: 950;
      white-space: nowrap;
    }

    .divider{
      height:1px;
      background: rgba(255,255,255,.08);
      margin: 14px 0;
    }

    /* ========= Modal ========= */
    .modal-overlay{
      position: fixed;
      inset: 0;
      z-index: 90;
      background: rgba(0,0,0,.60);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }
    .modal-overlay.is-open{ display:flex; }
    .modal{
      width: min(980px, 94vw);
      max-height: min(82vh, 760px);
      border-radius: var(--radius);
      overflow:hidden;
      position: relative;
    }
    .modal-header{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(10,8,14,.55);
    }
    .modal-title{
      margin:0;
      font-family: ui-serif, Georgia, serif;
      font-size: 18px;
      letter-spacing: -.2px;
    }
    .modal-close{
      width: 40px; height: 40px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.9);
      cursor: pointer;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .modal-body{
      padding: 16px;
      overflow:auto;
      background: rgba(7,6,11,.40);
    }
    body.modal-lock{ overflow:hidden; touch-action:none; }

    /* ========= Performance ========= */
    body.is-scrolling .interactive::before{ opacity:0 !important; }
    body.is-scrolling .interactive{ transition:none !important; }
    body.is-scrolling .glass{ box-shadow: 0 10px 30px rgba(0,0,0,.38) !important; }
    body.is-scrolling .topbar{
      backdrop-filter:none !important;
      -webkit-backdrop-filter:none !important;
    }

    @media (prefers-reduced-motion: reduce){
      html{ scroll-behavior:auto; }
      .interactive, .pill{ transition:none; }
    }

    @media (max-width: 980px){
      .hero-grid{ grid-template-columns: 1fr; }
      .layout{ grid-template-columns: 1fr; }
      .menu-btn{ display:inline-flex; }
      .nav{ display:none; }
      .grid-2{ grid-template-columns: 1fr; }
    }

    /* Desktop: blur off for smoothness */
    @media (min-width: 980px){
      .topbar{
        backdrop-filter:none;
        -webkit-backdrop-filter:none;
        background: rgba(8,6,12,.80);
      }
      body::before{ transform:none; will-change:auto; }
    }

    footer{
      padding: 18px 0 60px;
      border-top: 1px solid rgba(255,255,255,.08);
      background: rgba(10,8,14,.55);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .footer-row{
      display:flex;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
      color: rgba(255,255,255,.70);
      font-size: 13px;
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="container topbar-inner">
      <a class="brand" href="#" onclick="return false;" aria-label="Fitness Lady Admin">
        <span class="dot"></span>
        <span>Fitness Lady ‚Äî Admin</span>
      </a>

      <nav class="nav" aria-label="Admin men√º">
        <a href="#customers">Vev≈ëk</a>
        <a href="#editor">Szerkeszt≈ë</a>
        <a href="#export">Export/Import</a>
        <a href="#help">Seg√≠ts√©g</a>
      </nav>

      <div class="row">
        <button class="menu-btn" id="menuBtn" aria-label="Men√º">‚ò∞</button>
        <a class="pill ghost" href="/hu/" target="_blank" rel="noopener">F≈ëoldal</a>
        <a class="pill ghost" href="/hu/app/" target="_blank" rel="noopener">Vev≈ë oldal</a>
        <button class="pill primary" id="openInfoBtn" type="button">Info</button>
      </div>
    </div>
  </header>

  <div class="page">
    <!-- HERO -->
    <section class="hero">
      <div class="container">
        <div class="hero-grid">
          <div class="glass card interactive">
            <div class="kicker">üîí Admin fel√ºlet ‚Ä¢ v1 (statikus teszt)</div>
            <h1 class="h1">Vev≈ëk, csomagok, slotok, hozz√°f√©r√©s ‚Äî egy helyen.</h1>
            <p class="lead">
              Ez a v1 admin UI <b>backend n√©lk√ºl</b> fut: ment√©s <b>localStorage</b>-ba + <b>JSON export/import</b>.
              K√©s≈ëbb ugyanez a fel√ºlet r√°k√∂thet≈ë az admin API-ra (PHP/SQLite).
            </p>

            <div class="meta-row">
              <div class="meta-pill">üì¶ Csomagok: <b>Start 4h</b> ‚Ä¢ <b>Balance 6h (heti 4 video)</b> ‚Ä¢ <b>Pro 12h (heti 5 video)</b></div>
              <div class="meta-pill">üéØ Slotok: <b>3</b> (cser√©lhet≈ë)</div>
              <div class="meta-pill">üß† √ñr√∂k: <b>Technika</b> (mindig el√©rhet≈ë)</div>
            </div>
          </div>

          <div class="glass card interactive">
            <div class="title-row">
              <h2 class="title">Rendszer √°llapot</h2>
              <span class="tag" id="sysTag">DEMO</span>
            </div>
            <p class="small">
              Ment√©s helye: <b>csak a te b√∂ng√©sz≈ëdben</b> (localStorage). Export ut√°n tudod felt√∂lteni / √°tk√ºldeni.
            </p>

            <div class="divider"></div>

            <div class="row">
              <span class="badge">‚úÖ UI k√©sz</span>
              <span class="badge">üì§ Export</span>
              <span class="badge">üì• Import</span>
              <span class="badge">üîê Backend: k√©s≈ëbb</span>
            </div>

            <div class="divider"></div>

            <div class="row">
              <button class="pill primary" id="newCustomerQuickBtn" type="button">+ √öj vev≈ë</button>
              <button class="pill" id="backupBtn" type="button">Backup export</button>
              <button class="pill" id="resetBtn" type="button">Reset (csak demo)</button>
            </div>

            <div class="hint">
              <b>Biztons√°g:</b> ezt az admin oldalt a szerveren v√©dd <b>HTTP Basic Auth</b>-tal is (Hostpoint ‚Äúdirectory protection‚Äù),
              √≠gy m√°r a bel√©p√©s el≈ëtt jelsz√≥t k√©r.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- VEVO LISTA -->
    <section id="customers" class="section">
      <div class="container">
        <div class="section-head">
          <div>
            <h2 class="section-title">Vev≈ëk</h2>
            <p class="section-sub">
              Keres√©s email alapj√°n, st√°tusz, csomag, lej√°rat. Kattint√°sra megny√≠lik a szerkeszt≈ë.
            </p>
          </div>
          <div class="row">
            <input class="input" id="searchInput" placeholder="Keres√©s: email / n√©v" style="max-width:320px;">
            <button class="pill" id="createCustomerBtn" type="button">+ √öj vev≈ë</button>
          </div>
        </div>

        <div class="glass card interactive">
          <table class="table" aria-label="Vev≈ëk t√°bl√°zat">
            <thead>
              <tr>
                <th>Email</th>
                <th>N√©v</th>
                <th>Csomag</th>
                <th>St√°tusz</th>
                <th>Lej√°rat</th>
                <th>Heti vide√≥</th>
                <th>Slotok</th>
                <th style="width:150px;">M≈±velet</th>
              </tr>
            </thead>
            <tbody id="customersTbody"></tbody>
          </table>
          <div class="hint">
            <b>Tipp:</b> ha a vev≈ë ‚Äúlej√°rt‚Äù, a heti vide√≥k ‚Äústop‚Äù, de az <b>√ñr√∂k technika</b> marad.
          </div>
        </div>
      </div>
    </section>

    <!-- SZERKESZTO -->
    <section id="editor" class="section">
      <div class="container">
        <div class="section-head">
          <div>
            <h2 class="section-title">Szerkeszt≈ë</h2>
            <p class="section-sub">
              Itt √°ll√≠tod a csomagot, lej√°ratot, heti vide√≥kat √©s a 3 szem√©lyre szab√°s slotot (csere lista).
            </p>
          </div>
          <div class="row">
            <span class="badge" id="selectedBadge">Nincs kiv√°lasztva</span>
            <button class="pill primary" id="saveBtn" type="button">Ment√©s</button>
            <button class="pill" id="exportUserBtn" type="button">user.json export</button>
          </div>
        </div>

        <div class="layout">
          <!-- Left -->
          <div class="glass card interactive">
            <div class="title-row">
              <h3 class="title">Alap adatok</h3>
              <span class="tag" id="statusPill">‚Äî</span>
            </div>

            <div class="label">
              <span>Email (azonos√≠t√≥)</span>
              <input class="input" id="emailInput" placeholder="pl. vevo@email.com">
            </div>

            <div class="label">
              <span>N√©v</span>
              <input class="input" id="nameInput" placeholder="pl. Kiss Anna">
            </div>

            <div class="grid-2">
              <div class="label">
                <span>Csomag</span>
                <select class="select" id="packageSelect">
                  <option value="start">Start ‚Äî 4 h√©t</option>
                  <option value="balance">Balance ‚Äî 6 h√©t (heti 4 video)</option>
                  <option value="pro">Pro ‚Äî 12 h√©t (heti 5 video)</option>
                </select>
              </div>

              <div class="label">
                <span>St√°tusz</span>
                <select class="select" id="statusSelect">
                  <option value="active">Akt√≠v</option>
                  <option value="paused">Sz√ºnet</option>
                  <option value="expired">Lej√°rt</option>
                </select>
              </div>
            </div>

            <div class="grid-2">
              <div class="label">
                <span>Lej√°rat (d√°tum)</span>
                <input class="input" id="expiryInput" type="date">
              </div>

              <div class="label">
                <span>Heti vide√≥k</span>
                <select class="select" id="weeklySelect">
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4" selected>4</option>
                  <option value="5">5</option>
                </select>
              </div>
            </div>

            <div class="grid-2">
              <div class="label">
                <span>Jelsz√≥ (teszt)</span>
                <input class="input" id="passwordInput" placeholder="(k√©s≈ëbb hash + backend)">
              </div>
              <div class="label">
                <span>&nbsp;</span>
                <button class="pill" id="genPassBtn" type="button">Jelsz√≥ gener√°l√°s</button>
              </div>
            </div>

            <div class="divider"></div>

            <div class="title-row">
              <h3 class="title">Konzult√°ci√≥ / Megjegyz√©s</h3>
              <span class="tag">bels≈ë</span>
            </div>
            <textarea class="textarea" id="adminNoteInput" placeholder="Pl. c√©l: form√°sod√°s + er≈ë, t√©rd √©rz√©keny, heti 4 edz√©s. Slot 1: guggol√°s csere..."></textarea>

            <div class="divider"></div>

            <div class="row">
              <button class="pill primary" id="renewBtn" type="button">Meg√∫j√≠t√°s</button>
              <button class="pill" id="upgradeBtn" type="button">Upgrade</button>
              <button class="pill" id="deleteBtn" type="button">T√∂rl√©s</button>
            </div>

            <div class="hint">
              <b>Meg√∫j√≠t√°s:</b> √∫j lej√°ratot ad (csomag szerint).<br>
              <b>Upgrade:</b> Start ‚Üí Balance ‚Üí Pro (√©s heti vide√≥ automatikusan).
            </div>
          </div>

          <!-- Right -->
          <div class="glass card interactive">
            <div class="title-row">
              <h3 class="title">Program (vide√≥k + slotok)</h3>
              <span class="tag">3 slot</span>
            </div>

            <div class="label">
              <span>Heti f√≥kusz</span>
              <input class="input" id="weeklyFocusInput" placeholder="Pl. technika + stabil temp√≥">
            </div>
            <div class="label">
              <span>K√∂vetkez≈ë edz√©s</span>
              <input class="input" id="nextWorkoutInput" placeholder="Pl. 2. edz√©s ‚Äî als√≥test (25‚Äì35 perc)">
            </div>
            <div class="label">
              <span>Motiv√°ci√≥s sor</span>
              <input class="input" id="motivationInput" placeholder="Pl. Ma csak jelenj meg. A rendszer dolgozik.">
            </div>

            <div class="divider"></div>

            <div class="title-row">
              <h3 class="title">Vide√≥ lista (heti)</h3>
              <span class="tag" id="videosCountTag">‚Äî</span>
            </div>

            <div class="hint">
              √çrj be <b>c√≠met</b> √©s <b>le√≠r√°st</b>. A v1-ben m√©g nincs val√≥di vide√≥ link.
              K√©s≈ëbb ide j√∂n a v√©dett lej√°tsz√≥ azonos√≠t√≥ (Vimeo/Mux/Cloudflare Stream).
            </div>

            <div id="videosWrap"></div>

            <div class="divider"></div>

            <div class="title-row">
              <h3 class="title">Szem√©lyre szab√°s slotok</h3>
              <span class="tag">csere</span>
            </div>

            <div class="hint">
              Slot = amit te hetente cser√©lhetsz a vev≈ënek, a t√∂bbire nincs r√°l√°t√°sa.
            </div>

            <div class="grid-2">
              <div class="label">
                <span>Slot 1</span>
                <input class="input" id="slot1Input" placeholder="Pl. guggol√°s helyett box guggol√°s">
              </div>
              <div class="label">
                <span>Slot 2</span>
                <input class="input" id="slot2Input" placeholder="Pl. terhel√©s cs√∂kkent√©s / regresszi√≥">
              </div>
              <div class="label">
                <span>Slot 3</span>
                <input class="input" id="slot3Input" placeholder="Pl. mobilit√°s / core kieg√©sz√≠t√©s">
              </div>
              <div class="label">
                <span>√ñr√∂k technika hozz√°f√©r√©s</span>
                <select class="select" id="eternalSelect">
                  <option value="yes" selected>Igen (mindig)</option>
                  <option value="no">Nem</option>
                </select>
              </div>
            </div>

            <div class="divider"></div>

            <div class="row">
              <button class="pill primary" id="previewUserBtn" type="button">Vev≈ë JSON el≈ën√©zet</button>
              <button class="pill" id="copyUserJsonBtn" type="button">M√°sol√°s v√°g√≥lapra</button>
            </div>

            <div class="hint mono" id="jsonHint">
              user.json export: ezt fogod majd betenni a vev≈ë rendszerbe (k√©s≈ëbb automata API).
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- EXPORT / IMPORT -->
    <section id="export" class="section">
      <div class="container">
        <div class="section-head">
          <div>
            <h2 class="section-title">Export / Import</h2>
            <p class="section-sub">
              Teljes admin adatb√°zis (demo) export√°l√°sa / visszat√∂lt√©se. Ez a ‚Äúbackend n√©lk√ºli‚Äù ment√©sed.
            </p>
          </div>
          <div class="row">
            <button class="pill primary" id="exportAllBtn" type="button">Teljes export</button>
            <label class="pill" style="cursor:pointer;">
              Import JSON
              <input id="importFile" type="file" accept="application/json" style="display:none;">
            </label>
          </div>
        </div>

        <div class="glass card interactive">
          <div class="title-row">
            <h3 class="title">Admin DB JSON</h3>
            <span class="tag">backup</span>
          </div>
          <textarea class="textarea mono" id="dbPreview" readonly></textarea>

          <div class="row" style="margin-top:10px;">
            <button class="pill" id="copyDbBtn" type="button">M√°sol√°s</button>
            <button class="pill" id="downloadDbBtn" type="button">Let√∂lt√©s</button>
          </div>

          <div class="hint">
            <b>Figyelem:</b> a ‚Äúval√≥di B‚Äù (PHP/SQLite) eset√©n ez a r√©sz maradhat backupnak, de ment√©s m√°r a szerveren t√∂rt√©nik.
          </div>
        </div>
      </div>
    </section>

    <!-- HELP -->
    <section id="help" class="section">
      <div class="container">
        <div class="section-head">
          <div>
            <h2 class="section-title">Seg√≠ts√©g</h2>
            <p class="section-sub">Mit kell majd √∂sszek√∂tni, hogy √©les B legyen (fizet√©s ‚Üí user aktiv√°l√°s ‚Üí v√©dett vide√≥k).</p>
          </div>
          <div class="row">
            <button class="pill" id="openRoadmapBtn" type="button">Roadmap</button>
            <button class="pill primary" id="openSecurityBtn" type="button">Biztons√°g</button>
          </div>
        </div>

        <div class="glass card interactive">
          <div class="title-row">
            <h3 class="title">B √©les√≠t√©s checklist</h3>
            <span class="tag">k√∂vetkez≈ë</span>
          </div>
          <ul style="margin:0; padding-left:18px; color:rgba(255,255,255,.80); line-height:1.7; font-size:13.5px;">
            <li><b>admin.fitnesslady.ch</b> v√©d√©se HTTP Basic Auth-tal (Hostpoint Directory protection).</li>
            <li><b>PHP + SQLite</b> API: login, session cookie, users CRUD, entitlement.</li>
            <li><b>Payrexx webhook</b>: fizet√©s ut√°n user aktiv√°l√°s + csomag + lej√°rat.</li>
            <li><b>V√©dett vide√≥</b>: Vimeo/Mux/Cloudflare Stream signed playback token.</li>
            <li>Vev≈ë oldalon: csak bel√©pve, csak saj√°t csomag vide√≥k + √∂r√∂k technika.</li>
          </ul>
        </div>
      </div>
    </section>

    <footer>
      <div class="container footer-row">
        <div>¬© <span id="y"></span> Fitness Lady</div>
        <div>T√ºske web design</div>
      </div>
    </footer>
  </div>

  <!-- MODAL -->
  <div class="modal-overlay" id="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="glass modal" role="document">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">Info</h2>
        <button class="modal-close interactive" id="modalCloseBtn" type="button" aria-label="Bez√°r√°s">‚úï</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <script>
    // ====== util ======
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const nowYMD = () => new Date().toISOString().slice(0,10);

    function escapeHtml(s){
      return String(s ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function downloadText(filename, text){
      const blob = new Blob([text], {type:"application/json;charset=utf-8"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    function copyToClipboard(text){
      return navigator.clipboard?.writeText(text).catch(()=> {
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
      });
    }

    function randomPassword(len=10){
      const chars = "ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789!@#$%";
      let out = "";
      for(let i=0;i<len;i++) out += chars[Math.floor(Math.random()*chars.length)];
      return out;
    }

    // ====== scroll perf ======
    (() => {
      let t = null;
      const mark = () => {
        if(!document.body.classList.contains('is-scrolling')) document.body.classList.add('is-scrolling');
        clearTimeout(t);
        t = setTimeout(() => document.body.classList.remove('is-scrolling'), 180);
      };
      window.addEventListener('scroll', mark, { passive: true });
      window.addEventListener('wheel', mark, { passive: true });
    })();

    // ====== modal ======
    const modalOverlay = $("#modalOverlay");
    const modalCloseBtn = $("#modalCloseBtn");
    const modalTitle = $("#modalTitle");
    const modalBody = $("#modalBody");
    let lastFocus = null;

    function openModal(title, html){
      lastFocus = document.activeElement;
      modalTitle.textContent = title;
      modalBody.innerHTML = html;
      modalOverlay.classList.add('is-open');
      modalOverlay.setAttribute('aria-hidden','false');
      document.body.classList.add('modal-lock');
      modalCloseBtn.focus({preventScroll:true});
    }
    function closeModal(){
      modalOverlay.classList.remove('is-open');
      modalOverlay.setAttribute('aria-hidden','true');
      document.body.classList.remove('modal-lock');
      if(lastFocus?.focus) lastFocus.focus({preventScroll:true});
    }
    modalCloseBtn.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', (e)=>{ if(e.target===modalOverlay) closeModal(); });
    document.addEventListener('keydown', (e)=>{ if(modalOverlay.classList.contains('is-open') && e.key==='Escape') closeModal(); });

    // ====== year ======
    $("#y").textContent = new Date().getFullYear();

    // ====== data model ======
    const STORAGE_KEY = "fitnesslady_admin_db_v1";

    const packages = {
      start:   { key:"start",   name:"Start",   weeks:4,  weeklyVideos:2 },
      balance: { key:"balance", name:"Balance", weeks:6,  weeklyVideos:4 },
      pro:     { key:"pro",     name:"Pro",     weeks:12, weeklyVideos:5 },
    };

    function defaultVideos(count){
      const base = [
        { title:"Edz√©s 1 ‚Äî Teljes test (alap)", sub:"30‚Äì40 perc ‚Ä¢ temp√≥ + technika", level:"A" },
        { title:"Edz√©s 2 ‚Äî Als√≥test (form√°l√°s)", sub:"25‚Äì35 perc ‚Ä¢ farizom f√≥kusz", level:"B" },
        { title:"Edz√©s 3 ‚Äî Fels≈ëtest (tart√°s)", sub:"20‚Äì30 perc ‚Ä¢ v√°ll + h√°t", level:"A" },
        { title:"Edz√©s 4 ‚Äî Core + mobilit√°s", sub:"15‚Äì20 perc ‚Ä¢ stabilit√°s", level:"C" },
        { title:"Edz√©s 5 ‚Äî Extra (progresszi√≥)", sub:"25‚Äì35 perc ‚Ä¢ halad√≥", level:"B" }
      ];
      return base.slice(0, Math.max(1, Math.min(5, count))).map(v=>({...v}));
    }

    function makeCustomer(email=""){
      const pkg = packages.balance;
      const expiry = new Date();
      expiry.setDate(expiry.getDate() + (pkg.weeks * 7));
      return {
        id: crypto?.randomUUID?.() || ("id_" + Math.random().toString(16).slice(2)),
        email: email.trim().toLowerCase(),
        name: "",
        status: "active",
        packageKey: pkg.key,
        weeklyVideos: pkg.weeklyVideos,
        expiryYMD: expiry.toISOString().slice(0,10),
        password: "",
        adminNote: "",
        weeklyFocus: "T√∂k√©letes alapok: technika + stabil temp√≥.",
        nextWorkout: "2. edz√©s ‚Äî als√≥test (25‚Äì35 perc)",
        motivation: "Kis l√©p√©sek. Nagy v√°ltoz√°s. Ma csak jelenj meg.",
        videos: defaultVideos(pkg.weeklyVideos),
        slots: ["", "", ""],
        eternalTechnique: "yes",
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
      };
    }

    function loadDB(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return { version:1, updatedAt:new Date().toISOString(), customers: [] };
        const db = JSON.parse(raw);
        if(!db?.customers) throw new Error("bad db");
        return db;
      }catch{
        return { version:1, updatedAt:new Date().toISOString(), customers: [] };
      }
    }

    function saveDB(){
      db.updatedAt = new Date().toISOString();
      localStorage.setItem(STORAGE_KEY, JSON.stringify(db, null, 2));
      renderDBPreview();
      renderCustomersTable();
      updateSysTag();
    }

    function updateSysTag(){
      const count = db.customers.length;
      $("#sysTag").textContent = count ? `DEMO ‚Ä¢ ${count} vev≈ë` : "DEMO";
    }

    let db = loadDB();

    // ====== rendering: customers table ======
    const tbody = $("#customersTbody");
    const searchInput = $("#searchInput");

    function statusBadge(status, expiryYMD){
      const today = nowYMD();
      let s = status;
      if(s === "active" && expiryYMD && expiryYMD < today) s = "expired";

      if(s === "active") return `<span class="tag ok">Akt√≠v</span>`;
      if(s === "paused") return `<span class="tag warn">Sz√ºnet</span>`;
      return `<span class="tag bad">Lej√°rt</span>`;
    }

    function pkgLabel(c){
      const p = packages[c.packageKey] || packages.balance;
      return `${p.name} (${p.weeks} h√©t)`;
    }

    function renderCustomersTable(){
      const q = (searchInput.value || "").trim().toLowerCase();
      const rows = db.customers
        .filter(c => {
          if(!q) return true;
          return (c.email||"").includes(q) || (c.name||"").toLowerCase().includes(q);
        })
        .sort((a,b)=> (a.email||"").localeCompare(b.email||""));

      tbody.innerHTML = rows.map(c => {
        const p = packages[c.packageKey] || packages.balance;
        const status = statusBadge(c.status, c.expiryYMD);
        const slots = (c.slots||[]).filter(Boolean).length + "/3";
        return `
          <tr data-id="${escapeHtml(c.id)}">
            <td class="mono">${escapeHtml(c.email || "‚Äî")}</td>
            <td>${escapeHtml(c.name || "‚Äî")}</td>
            <td>${escapeHtml(p.name)}</td>
            <td>${status}</td>
            <td class="mono">${escapeHtml(c.expiryYMD || "‚Äî")}</td>
            <td>${escapeHtml(String(c.weeklyVideos ?? p.weeklyVideos))}</td>
            <td>${escapeHtml(slots)}</td>
            <td>
              <div class="row">
                <button class="pill primary" data-action="edit">Szerkeszt</button>
                <button class="pill" data-action="export">user.json</button>
              </div>
            </td>
          </tr>
        `;
      }).join("") || `
        <tr><td colspan="8" style="color:rgba(255,255,255,.65);">Nincs tal√°lat.</td></tr>
      `;
    }

    searchInput.addEventListener('input', renderCustomersTable);

    // ====== editor bindings ======
    const selectedBadge = $("#selectedBadge");
    const statusPill = $("#statusPill");

    const emailInput = $("#emailInput");
    const nameInput = $("#nameInput");
    const packageSelect = $("#packageSelect");
    const statusSelect = $("#statusSelect");
    const expiryInput = $("#expiryInput");
    const weeklySelect = $("#weeklySelect");
    const passwordInput = $("#passwordInput");
    const adminNoteInput = $("#adminNoteInput");

    const weeklyFocusInput = $("#weeklyFocusInput");
    const nextWorkoutInput = $("#nextWorkoutInput");
    const motivationInput = $("#motivationInput");

    const slot1Input = $("#slot1Input");
    const slot2Input = $("#slot2Input");
    const slot3Input = $("#slot3Input");
    const eternalSelect = $("#eternalSelect");

    const videosWrap = $("#videosWrap");
    const videosCountTag = $("#videosCountTag");

    let selectedId = null;

    function getSelected(){
      return db.customers.find(c => c.id === selectedId) || null;
    }

    function computeStatusForUI(c){
      const today = nowYMD();
      let s = c.status;
      if(s === "active" && c.expiryYMD && c.expiryYMD < today) s = "expired";
      return s;
    }

    function setStatusPill(s){
      if(s === "active"){
        statusPill.className = "tag ok";
        statusPill.textContent = "Akt√≠v";
      } else if(s === "paused"){
        statusPill.className = "tag warn";
        statusPill.textContent = "Sz√ºnet";
      } else {
        statusPill.className = "tag bad";
        statusPill.textContent = "Lej√°rt";
      }
    }

    function renderVideosEditor(c){
      const count = Number(c.weeklyVideos || 0) || 0;
      videosCountTag.textContent = `Heti ${count} vide√≥`;
      const arr = c.videos || [];
      // Ensure array length
      while(arr.length < count) arr.push({ title:"", sub:"", level:"" });
      while(arr.length > count) arr.pop();
      c.videos = arr;

      videosWrap.innerHTML = arr.map((v, i) => `
        <div class="glass" style="padding:12px; border-radius:18px; border:1px solid rgba(255,255,255,.08); background: rgba(255,255,255,.03); margin-top:10px;">
          <div class="row" style="justify-content:space-between;">
            <div class="badge">üé¨ Vide√≥ ${i+1}</div>
            <div class="row">
              <span class="badge">Szint</span>
              <input class="input mono" data-vfield="level" data-idx="${i}" value="${escapeHtml(v.level||"")}" placeholder="A / B / C" style="max-width:110px;">
            </div>
          </div>

          <div class="label">
            <span>C√≠m</span>
            <input class="input" data-vfield="title" data-idx="${i}" value="${escapeHtml(v.title||"")}" placeholder="Pl. Edz√©s 2 ‚Äî Als√≥test (form√°l√°s)">
          </div>

          <div class="label">
            <span>Le√≠r√°s</span>
            <input class="input" data-vfield="sub" data-idx="${i}" value="${escapeHtml(v.sub||"")}" placeholder="Pl. 25‚Äì35 perc ‚Ä¢ farizom f√≥kusz">
          </div>
        </div>
      `).join("");
    }

    function fillEditor(c){
      selectedId = c?.id || null;
      if(!c){
        selectedBadge.textContent = "Nincs kiv√°lasztva";
        setStatusPill("expired");
        return;
      }

      selectedBadge.textContent = `Kiv√°lasztva: ${c.email || c.name || c.id}`;
      const s = computeStatusForUI(c);
      setStatusPill(s);

      emailInput.value = c.email || "";
      nameInput.value = c.name || "";
      packageSelect.value = c.packageKey || "balance";
      statusSelect.value = c.status || "active";
      expiryInput.value = c.expiryYMD || "";
      weeklySelect.value = String(c.weeklyVideos ?? packages[c.packageKey]?.weeklyVideos ?? 4);
      passwordInput.value = c.password || "";
      adminNoteInput.value = c.adminNote || "";

      weeklyFocusInput.value = c.weeklyFocus || "";
      nextWorkoutInput.value = c.nextWorkout || "";
      motivationInput.value = c.motivation || "";

      slot1Input.value = c.slots?.[0] || "";
      slot2Input.value = c.slots?.[1] || "";
      slot3Input.value = c.slots?.[2] || "";
      eternalSelect.value = c.eternalTechnique || "yes";

      renderVideosEditor(c);
    }

    function sanitizeEmail(s){
      return String(s||"").trim().toLowerCase();
    }

    function applyPackageDefaults(c){
      const p = packages[c.packageKey] || packages.balance;
      // If weeklySelect not explicitly set, align with package default:
      c.weeklyVideos = Number(c.weeklyVideos || p.weeklyVideos);
      // Ensure within 1..5
      c.weeklyVideos = Math.max(1, Math.min(5, c.weeklyVideos));
      // videos array adjust
      c.videos = (c.videos || []);
      while(c.videos.length < c.weeklyVideos) c.videos.push({ title:"", sub:"", level:"" });
      while(c.videos.length > c.weeklyVideos) c.videos.pop();
    }

    function weeksForPackage(key){
      return (packages[key] || packages.balance).weeks;
    }

    function renewCustomer(c){
      const weeks = weeksForPackage(c.packageKey);
      const d = new Date();
      d.setDate(d.getDate() + weeks*7);
      c.expiryYMD = d.toISOString().slice(0,10);
      c.status = "active";
      c.updatedAt = new Date().toISOString();
    }

    function upgradeCustomer(c){
      const order = ["start", "balance", "pro"];
      const idx = Math.max(0, order.indexOf(c.packageKey));
      const next = order[Math.min(order.length-1, idx+1)];
      c.packageKey = next;
      const p = packages[next];
      c.weeklyVideos = p.weeklyVideos;
      renewCustomer(c);
      applyPackageDefaults(c);
      c.updatedAt = new Date().toISOString();
    }

    function saveFromEditor(){
      const c = getSelected();
      if(!c){
        openModal("Hiba", `<p>Nincs kiv√°lasztva vev≈ë. V√°lassz a list√°b√≥l vagy hozz l√©tre √∫jat.</p>`);
        return;
      }

      const newEmail = sanitizeEmail(emailInput.value);
      if(!newEmail){
        openModal("Hiba", `<p><b>Email k√∂telez≈ë.</b> Ez lesz az azonos√≠t√≥.</p>`);
        return;
      }

      // unique email check (except self)
      const clash = db.customers.find(x => x.email === newEmail && x.id !== c.id);
      if(clash){
        openModal("Hiba", `<p>Ez az email m√°r l√©tezik: <b>${escapeHtml(newEmail)}</b></p>`);
        return;
      }

      c.email = newEmail;
      c.name = nameInput.value.trim();
      c.packageKey = packageSelect.value;
      c.status = statusSelect.value;
      c.expiryYMD = expiryInput.value || nowYMD();
      c.weeklyVideos = Number(weeklySelect.value || 4);
      c.password = passwordInput.value;
      c.adminNote = adminNoteInput.value;

      c.weeklyFocus = weeklyFocusInput.value.trim();
      c.nextWorkout = nextWorkoutInput.value.trim();
      c.motivation = motivationInput.value.trim();

      c.slots = [
        slot1Input.value.trim(),
        slot2Input.value.trim(),
        slot3Input.value.trim(),
      ];
      c.eternalTechnique = eternalSelect.value;

      // video fields from UI
      const fields = $$("[data-vfield]", videosWrap);
      for(const el of fields){
        const idx = Number(el.getAttribute("data-idx"));
        const field = el.getAttribute("data-vfield");
        c.videos[idx] = c.videos[idx] || { title:"", sub:"", level:"" };
        c.videos[idx][field] = el.value;
      }

      applyPackageDefaults(c);
      c.updatedAt = new Date().toISOString();

      fillEditor(c);
      saveDB();

      openModal("Mentve", `
        <p><b>Ok√©.</b> Mentve localStorage-ba.</p>
        <p class="mono">Email: ${escapeHtml(c.email)} ‚Ä¢ Csomag: ${escapeHtml(packages[c.packageKey]?.name)} ‚Ä¢ Lej√°rat: ${escapeHtml(c.expiryYMD)}</p>
      `);
    }

    // ====== user.json builder (for vev≈ë oldal) ======
    function buildUserJson(c){
      const p = packages[c.packageKey] || packages.balance;
      const statusUI = computeStatusForUI(c);

      return {
        version: 1,
        user: {
          email: c.email,
          name: c.name || "",
          status: statusUI, // active/paused/expired
          package: p.name,
          packageKey: c.packageKey,
          durationWeeks: p.weeks,
          weeklyVideos: Number(c.weeklyVideos ?? p.weeklyVideos),
          expiryYMD: c.expiryYMD,
          eternalTechnique: c.eternalTechnique === "yes",
        },
        program: {
          weeklyFocus: c.weeklyFocus || "",
          nextWorkout: c.nextWorkout || "",
          motivation: c.motivation || "",
          slots: {
            slot1: c.slots?.[0] || "",
            slot2: c.slots?.[1] || "",
            slot3: c.slots?.[2] || "",
          },
          videos: (c.videos || []).slice(0, Number(c.weeklyVideos || p.weeklyVideos)).map(v => ({
            title: v.title || "",
            sub: v.sub || "",
            level: v.level || ""
          })),
          // NOTE: later add protectedPlaybackId, etc.
        },
        admin: {
          note: c.adminNote || "",
          updatedAt: c.updatedAt,
        }
      };
    }

    function exportUserJson(c){
      const json = buildUserJson(c);
      const safeEmail = (c.email || "user").replaceAll(/[^a-z0-9\-_\.@]/g, "_");
      downloadText(`user_${safeEmail}.json`, JSON.stringify(json, null, 2));
    }

    // ====== db preview ======
    const dbPreview = $("#dbPreview");
    function renderDBPreview(){
      dbPreview.value = JSON.stringify(db, null, 2);
    }

    // ====== events ======
    $("#saveBtn").addEventListener('click', saveFromEditor);
    $("#exportUserBtn").addEventListener('click', () => {
      const c = getSelected();
      if(!c) return openModal("Hiba", `<p>Nincs kiv√°lasztva vev≈ë.</p>`);
      exportUserJson(c);
    });

    $("#previewUserBtn").addEventListener('click', () => {
      const c = getSelected();
      if(!c) return openModal("Hiba", `<p>Nincs kiv√°lasztva vev≈ë.</p>`);
      const json = buildUserJson(c);
      openModal("Vev≈ë JSON el≈ën√©zet", `
        <p class="small">Ezt fogja a vev≈ë oldal beolvasni (k√©s≈ëbb automata API-b√≥l).</p>
        <pre class="mono" style="white-space:pre-wrap; background: rgba(0,0,0,.22); border:1px solid rgba(255,255,255,.10); padding:12px; border-radius:16px; margin:10px 0 0;">${escapeHtml(JSON.stringify(json, null, 2))}</pre>
      `);
    });

    $("#copyUserJsonBtn").addEventListener('click', async () => {
      const c = getSelected();
      if(!c) return openModal("Hiba", `<p>Nincs kiv√°lasztva vev≈ë.</p>`);
      const json = JSON.stringify(buildUserJson(c), null, 2);
      await copyToClipboard(json);
      openModal("M√°solva", `<p>Vev≈ë JSON a v√°g√≥lapon.</p>`);
    });

    $("#genPassBtn").addEventListener('click', () => {
      passwordInput.value = randomPassword(12);
      openModal("Jelsz√≥", `<p>Gener√°lt jelsz√≥: <b class="mono">${escapeHtml(passwordInput.value)}</b></p><p class="small">√âlesben ezt majd hash-elve t√°roljuk a backendben.</p>`);
    });

    $("#renewBtn").addEventListener('click', () => {
      const c = getSelected();
      if(!c) return openModal("Hiba", `<p>Nincs kiv√°lasztva vev≈ë.</p>`);
      renewCustomer(c);
      fillEditor(c);
      saveDB();
      openModal("Meg√∫j√≠tva", `<p>√öj lej√°rat: <b class="mono">${escapeHtml(c.expiryYMD)}</b></p>`);
    });

    $("#upgradeBtn").addEventListener('click', () => {
      const c = getSelected();
      if(!c) return openModal("Hiba", `<p>Nincs kiv√°lasztva vev≈ë.</p>`);
      const before = c.packageKey;
      upgradeCustomer(c);
      fillEditor(c);
      saveDB();
      openModal("Upgrade k√©sz", `<p><b>${escapeHtml(packages[before]?.name)}</b> ‚Üí <b>${escapeHtml(packages[c.packageKey]?.name)}</b></p>`);
    });

    $("#deleteBtn").addEventListener('click', () => {
      const c = getSelected();
      if(!c) return openModal("Hiba", `<p>Nincs kiv√°lasztva vev≈ë.</p>`);
      openModal("T√∂rl√©s", `
        <p>Biztos t√∂rl√∂d? <b class="mono">${escapeHtml(c.email)}</b></p>
        <div class="row" style="margin-top:10px;">
          <button class="pill primary" id="confirmDeleteBtn" type="button">Igen, t√∂rl√∂m</button>
          <button class="pill" id="cancelDeleteBtn" type="button">M√©gse</button>
        </div>
      `);

      setTimeout(() => {
        $("#confirmDeleteBtn")?.addEventListener('click', () => {
          db.customers = db.customers.filter(x => x.id !== c.id);
          selectedId = null;
          saveDB();
          fillEditor(null);
          closeModal();
        });
        $("#cancelDeleteBtn")?.addEventListener('click', closeModal);
      }, 0);
    });

    function createCustomerFlow(prefillEmail=""){
      const c = makeCustomer(prefillEmail);
      // if email already exists -> empty email
      if(prefillEmail){
        const exists = db.customers.some(x => x.email === sanitizeEmail(prefillEmail));
        if(exists) c.email = "";
      }
      db.customers.push(c);
      selectedId = c.id;
      fillEditor(c);
      saveDB();
      location.hash = "#editor";
      openModal("√öj vev≈ë", `<p>Vev≈ë l√©trehozva. T√∂ltsd ki az emailt, majd <b>Ment√©s</b>.</p>`);
    }

    $("#createCustomerBtn").addEventListener('click', () => createCustomerFlow(""));
    $("#newCustomerQuickBtn").addEventListener('click', () => createCustomerFlow(""));

    // Table row actions
    tbody.addEventListener('click', (e) => {
      const tr = e.target?.closest('tr[data-id]');
      if(!tr) return;
      const id = tr.getAttribute('data-id');
      const c = db.customers.find(x => x.id === id);
      if(!c) return;

      const btn = e.target?.closest('button[data-action]');
      if(!btn){
        selectedId = c.id;
        fillEditor(c);
        location.hash = "#editor";
        return;
      }

      const action = btn.getAttribute('data-action');
      if(action === "edit"){
        selectedId = c.id;
        fillEditor(c);
        location.hash = "#editor";
      } else if(action === "export"){
        exportUserJson(c);
      }
    });

    // Update weekly defaults when package changed
    packageSelect.addEventListener('change', () => {
      const key = packageSelect.value;
      const p = packages[key] || packages.balance;
      weeklySelect.value = String(p.weeklyVideos);
      // If a customer selected, update immediately for editing preview
      const c = getSelected();
      if(c){
        c.packageKey = key;
        c.weeklyVideos = p.weeklyVideos;
        applyPackageDefaults(c);
        fillEditor(c);
      } else {
        // render editor videos by reading weeklySelect
        const temp = makeCustomer("");
        temp.packageKey = key;
        temp.weeklyVideos = p.weeklyVideos;
        renderVideosEditor(temp);
      }
    });

    weeklySelect.addEventListener('change', () => {
      const c = getSelected();
      const count = Number(weeklySelect.value || 4);
      if(c){
        c.weeklyVideos = count;
        applyPackageDefaults(c);
        fillEditor(c);
      } else {
        const temp = makeCustomer("");
        temp.weeklyVideos = count;
        renderVideosEditor(temp);
      }
    });

    // Info button
    $("#openInfoBtn").addEventListener('click', () => {
      openModal("Info", `
        <p><b>Ez a v1 admin UI statikus.</b></p>
        <p>Ment√©s: <b>localStorage</b>. Export: <b>JSON f√°jl</b>.</p>
        <div class="divider"></div>
        <p class="small"><b>K√∂vetkez≈ë (B √©les):</b> PHP + SQLite API + Payrexx webhook + v√©dett vide√≥ token.</p>
      `);
    });

    // Backup/export buttons
    function backupExport(){
      const payload = JSON.stringify(db, null, 2);
      downloadText(`fitnesslady_admin_db_backup_${nowYMD()}.json`, payload);
    }
    $("#backupBtn").addEventListener('click', backupExport);

    $("#exportAllBtn").addEventListener('click', () => {
      renderDBPreview();
      openModal("Teljes export", `<p>DB export f√°jl let√∂lt√©se indul.</p>`);
      backupExport();
    });

    $("#copyDbBtn").addEventListener('click', async () => {
      await copyToClipboard(dbPreview.value || "");
      openModal("M√°solva", `<p>Admin DB JSON a v√°g√≥lapon.</p>`);
    });
    $("#downloadDbBtn").addEventListener('click', () => {
      downloadText(`fitnesslady_admin_db_${nowYMD()}.json`, dbPreview.value || "{}");
    });

    $("#downloadDbBtn").addEventListener('click', ()=>{});

    $("#exportAllBtn").addEventListener('click', ()=>{});

    // import
    $("#importFile").addEventListener('change', async (e) => {
      const file = e.target.files?.[0];
      if(!file) return;
      try{
        const text = await file.text();
        const obj = JSON.parse(text);
        if(!obj?.customers || !Array.isArray(obj.customers)) throw new Error("Invalid format");
        db = obj;
        selectedId = null;
        saveDB();
        fillEditor(null);
        openModal("Import k√©sz", `<p>DB bet√∂ltve.</p>`);
      }catch(err){
        openModal("Hiba", `<p>Import sikertelen: <b>${escapeHtml(err.message || String(err))}</b></p>`);
      } finally {
        e.target.value = "";
      }
    });

    // reset
    $("#resetBtn").addEventListener('click', () => {
      openModal("Reset (demo)", `
        <p>Biztos t√∂rl√∂d a helyi (localStorage) adatokat?</p>
        <div class="row" style="margin-top:10px;">
          <button class="pill primary" id="confirmResetBtn" type="button">Igen, reset</button>
          <button class="pill" id="cancelResetBtn" type="button">M√©gse</button>
        </div>
      `);
      setTimeout(() => {
        $("#confirmResetBtn")?.addEventListener('click', () => {
          localStorage.removeItem(STORAGE_KEY);
          db = { version:1, updatedAt:new Date().toISOString(), customers: [] };
          selectedId = null;
          saveDB();
          fillEditor(null);
          closeModal();
        });
        $("#cancelResetBtn")?.addEventListener('click', closeModal);
      }, 0);
    });

    // roadmap/security
    $("#openRoadmapBtn").addEventListener('click', () => {
      openModal("Roadmap (B)", `
        <h3>1) Admin v√©delem</h3>
        <p>admin.fitnesslady.ch ‚Üí HTTP Basic Auth + SSL.</p>
        <h3>2) Backend (PHP + SQLite)</h3>
        <p>/api/login, /api/logout, /api/users, /api/user/:email</p>
        <h3>3) Fizet√©s (Payrexx)</h3>
        <p>Webhook ‚Üí user aktiv√°l√°s, csomag, lej√°rat, email.</p>
        <h3>4) V√©dett vide√≥</h3>
        <p>Signed playback token / DRM-szer≈± ‚Äúnem megoszthat√≥‚Äù lej√°tsz√°s.</p>
      `);
    });

    $("#openSecurityBtn").addEventListener('click', () => {
      openModal("Biztons√°g", `
        <p><b>Minimum:</b> admin.fitnesslady.ch mappa jelszavas v√©delme szerveren (Basic Auth).</p>
        <p><b>K√©s≈ëbb:</b> admin login a backendben (session cookie), rate limit, audit log.</p>
        <p><b>Vide√≥k:</b> signed tokens, domain restriction, expiring URLs.</p>
      `);
    });

    // mobile nav (simple)
    const menuBtn = $("#menuBtn");
    let mobileOpen = false;
    menuBtn?.addEventListener("click", () => {
      mobileOpen = !mobileOpen;
      if(mobileOpen){
        const nav = document.createElement("div");
        nav.id = "mobileNav";
        nav.style.position = "fixed";
        nav.style.top = "64px";
        nav.style.left = "14px";
        nav.style.right = "14px";
        nav.style.zIndex = "60";
        nav.style.background = "rgba(20,12,26,.72)";
        nav.style.border = "1px solid rgba(255,255,255,.10)";
        nav.style.borderRadius = "18px";
        nav.style.backdropFilter = "blur(14px)";
        nav.style.boxShadow = "0 20px 70px rgba(0,0,0,.55)";
        nav.style.padding = "12px";
        nav.innerHTML = `
          <a href="#customers" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">Vev≈ëk</a>
          <a href="#editor" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">Szerkeszt≈ë</a>
          <a href="#export" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">Export/Import</a>
          <a href="#help" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">Seg√≠ts√©g</a>
          <a href="/hu/" target="_blank" rel="noopener" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">F≈ëoldal</a>
          <a href="/hu/app/" target="_blank" rel="noopener" style="display:block; padding:10px 10px; color:rgba(255,255,255,.86)">Vev≈ë oldal</a>
        `;
        document.body.appendChild(nav);
      } else {
        $("#mobileNav")?.remove();
      }
    });
    document.addEventListener("click", (e) => {
      const nav = $("#mobileNav");
      if(!nav) return;
      if(e.target === menuBtn) return;
      if(nav.contains(e.target)) {
        nav.remove();
        mobileOpen = false;
      }
    });

    // tap glow
    function enableTapGlow(selector=".interactive"){
      $$(selector).forEach(el=>{
        el.addEventListener("touchstart", ()=>{
          el.classList.add("is-active");
          clearTimeout(el.__t);
          el.__t = setTimeout(()=>el.classList.remove("is-active"), 650);
        }, {passive:true});
      });
    }
    enableTapGlow();

    // top nav active underline
    (() => {
      const links = Array.from($$('.nav a')).filter(a=>a.getAttribute('href')?.startsWith('#'));
      const sections = links.map(a=>$(a.getAttribute('href'))).filter(Boolean);
      if(!sections.length) return;
      const setActive = (id) => links.forEach(a => a.classList.toggle('is-active', a.getAttribute('href') === `#${id}`));
      const io = new IntersectionObserver((entries)=>{
        const visible = entries.filter(e=>e.isIntersecting).sort((a,b)=>b.intersectionRatio-a.intersectionRatio)[0];
        if(visible?.target?.id) setActive(visible.target.id);
      }, { threshold: [0.2, 0.35, 0.5] });
      sections.forEach(s=>io.observe(s));
    })();

    // quick actions
    $("#backupBtn").addEventListener('click', ()=>{});
    $("#newCustomerQuickBtn").addEventListener('click', ()=>{});

    // global: backup
    $("#backupBtn").addEventListener('click', backupExport);

    // reset duplicates safe
    $("#backupBtn").addEventListener('click', ()=>{});

    // customers: quick create with prompt
    $("#createCustomerBtn").addEventListener('click', () => {
      openModal("√öj vev≈ë", `
        <p>Adj meg egy email c√≠met (opcion√°lis). L√©trehozzuk a vev≈ët, majd a szerkeszt≈ëben kit√∂lt√∂d a t√∂bbit.</p>
        <div class="label">
          <span>Email</span>
          <input class="input" id="newEmailPrompt" placeholder="vevo@email.com">
        </div>
        <div class="row" style="margin-top:10px;">
          <button class="pill primary" id="createNowBtn" type="button">L√©trehoz√°s</button>
          <button class="pill" id="cancelCreateBtn" type="button">M√©gse</button>
        </div>
      `);
      setTimeout(() => {
        $("#cancelCreateBtn")?.addEventListener('click', closeModal);
        $("#createNowBtn")?.addEventListener('click', () => {
          const email = sanitizeEmail($("#newEmailPrompt")?.value || "");
          closeModal();
          createCustomerFlow(email);
        });
        $("#newEmailPrompt")?.focus({preventScroll:true});
      }, 0);
    });

    $("#newCustomerQuickBtn").addEventListener('click', () => createCustomerFlow(""));

    // backup button (hero)
    $("#backupBtn").addEventListener('click', backupExport);

    // export in hero card
    $("#backupBtn").addEventListener('click', ()=>{});

    // db preview sync
    function renderDBPreview(){
      dbPreview.value = JSON.stringify(db, null, 2);
    }

    // export all button also updates preview
    $("#exportAllBtn").addEventListener('click', ()=>{});

    // hook other buttons to backup
    $("#backupBtn").addEventListener('click', backupExport);

    // "backup export" shortcut
    $("#backupBtn").addEventListener('click', ()=>{});

    // universal: export all (already) - keep preview fresh
    $("#exportAllBtn").addEventListener('click', () => {
      renderDBPreview();
      backupExport();
    });

    // also allow table export from row
    // already

    // "Backup export" near top
    $("#backupBtn").addEventListener('click', ()=>{});

    // "Backup export" in header card
    $("#backupBtn").addEventListener('click', ()=>{});

    // quick backup from "Backup export" button
    $("#backupBtn").addEventListener('click', ()=>{});

    // backup from "backupBtn" already

    // custom: backup + show modal
    $("#backupBtn").addEventListener('click', () => {
      renderDBPreview();
      openModal("Backup export", `<p>Let√∂lt√©s indul: <b class="mono">fitnesslady_admin_db_backup_${nowYMD()}.json</b></p>`);
      backupExport();
    });

    // Also "exportAllBtn" show modal
    $("#exportAllBtn").addEventListener('click', () => {
      renderDBPreview();
      openModal("Teljes export", `<p>Let√∂lt√©s indul: <b class="mono">fitnesslady_admin_db_backup_${nowYMD()}.json</b></p>`);
      backupExport();
    });

    // db preview load
    renderDBPreview();
    renderCustomersTable();
    updateSysTag();
    fillEditor(null);

    // If empty db, create a demo customer for easier testing
    if(db.customers.length === 0){
      const demo = makeCustomer("demo@fitnesslady.ch");
      demo.name = "Demo Vev≈ë";
      demo.password = randomPassword(10);
      demo.adminNote = "Demo vev≈ë ‚Äî teszteld a szerkeszt≈ët √©s a user.json exportot.";
      db.customers.push(demo);
      saveDB();
      fillEditor(demo);
    }

    // Export user from table works; also allow quick export after save
    $("#backupBtn").addEventListener('click', ()=>{});

  </script>
</body>
</html>
